{% extends 'base/base.html' %}

{% block title %}Pedidos - DataLab{% endblock %}

{% block content %}
<div class="pedidos-container">
    <!-- Herramientas -->
    <div class="tools-card">
        <div class="card-header">
            <h5 class="card-title">
                <i class="fas fa-tools me-2"></i>
                <span>Herramientas de Pedidos</span>
            </h5>
        </div>
        <div class="card-body">
            <div class="tools-actions">
                <div class="tooltip-wrapper">
                    <button type="button" class="btn btn--primary btn--icon" id="btn-nuevo-pedido" title="Nuevo Pedido">
                        <i class="fas fa-plus"></i>
                    </button>
                    <span class="tooltip">Nuevo Pedido</span>
                </div>
                
                <div class="tooltip-wrapper">
                    <button type="button" class="btn btn--accent btn--icon" id="btn-editar-pedido" title="Editar Pedido" disabled>
                        <i class="fas fa-edit"></i>
                    </button>
                    <span class="tooltip">Editar Pedido</span>
                </div>
                
                <div class="tooltip-wrapper">
                    <button type="button" class="btn btn--danger btn--icon" id="btn-eliminar-pedido" title="Eliminar Pedido" disabled>
                        <i class="fas fa-trash-alt"></i>
                    </button>
                    <span class="tooltip">Eliminar Pedido</span>
                </div>
                
                <div class="divider"></div>
                
                <div class="tooltip-wrapper">
                    <a href="#" class="btn btn--info btn--icon" id="btn-informes" title="Ver Informes">
                        <i class="fas fa-chart-line"></i>
                    </a>
                    <span class="tooltip">Ver Informes</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Formulario de Nuevo Pedido -->
    <div class="form-card" id="form-nuevo-pedido">
        <div class="form-card__header">
            <h3 class="form-card__title">Nuevo Pedido</h3>
        </div>
        <div class="form-card__body">
            <form id="pedido-form" class="form" novalidate>
                <div class="form__grid">
                    <div class="form__group">
                        <label for="numero_pedido" class="form__label form__label--required">Número de Pedido</label>
                        <input type="text" 
                               class="form__input" 
                               id="numero_pedido" 
                               name="numero_pedido" 
                               placeholder="Ingrese el número de pedido"
                               required>
                        <div class="form__error">Por favor ingrese el número de pedido</div>
                    </div>
                    
                    <div class="form__group">
                        <label for="cliente_id" class="form__label form__label--required">Cliente</label>
                        <select class="form__select" id="cliente_id" name="cliente_id" required>
                            <option value="" selected disabled>Seleccione un cliente...</option>
                            <!-- Se llenará dinámicamente con JavaScript -->
                        </select>
                        <div class="form_error">Por favor seleccione un cliente</div>
                    </div>

                    <div class="form_group form__group--full">
                        <label for="descripcion" class="form__label">Descripción</label>
                        <textarea class="form__textarea" 
                                  id="descripcion" 
                                  name="descripcion" 
                                  rows="3"
                                  placeholder="Agregue una descripción del pedido (opcional)"></textarea>
                    </div>
                </div>

                <div class="form__actions">
                    <button type="button" class="btn btn--outline" id="btn-cancelar">
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn--primary">
                        <span class="spinner" id="spinner"></span>
                        <span id="btn-text">Guardar Pedido</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Últimos Clientes Agregados -->
    <div class="latest-clients-card shadow mb-4">
        <div class="card-header card-header--has-btn">
            <h5 class="card-title"><i class="ri-group-line"></i> <span>Últimos Clientes Agregados</span></h5>
            <button type="button" class="btn btn-info btn-sm mt-3" onclick="window.location.href='/clientes'">
                Gestionar Clientes
            </button>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover" id="ultimos-clientes-table">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Email</th>
                            <th>Teléfono</th>
                            <th>Fecha Registro</th>
                        </tr>
                    </thead>
                    <tbody id="ultimos-clientes-list">
                        <!-- Clientes cargados dinámicamente aquí -->
                        <tr>
                            <td colspan="4" class="text-center">Cargando últimos clientes...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/pedidos.js') }}"></script>
{% endblock %}
